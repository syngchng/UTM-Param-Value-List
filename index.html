<!DOCTYPE html>
<html lang="ko"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UTM 항목 Value List</title>
<style>
    body { font-family: sans-serif; margin: 20px; font-size: 14px; }
    .button-container { margin-bottom: 20px; } 
    .button-container button { padding: 10px 15px; font-size: 1em; cursor: pointer; background-color: #fb0e69; color: white; border: none; border-radius: 5px; }
    .button-container button:hover { background-color: #f81e72; }
    table { width: 100%; border-collapse: collapse; table-layout: fixed; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; vertical-align: top; word-wrap: break-word; }
    th { background-color: #f0f0f0; position: sticky; top: 0; z-index: 1;}
    #loadingStatus { font-style: italic; color: #777; margin-bottom: 15px; }
    #tableContainerWrapper { max-height: 70vh; overflow-y: auto; border: 1px solid #ddd; }
</style>
</head>
<body data-new-gr-c-s-check-loaded="14.1235.0" data-gr-ext-installed="">

<h1 style="
  display: inline-block;
">UTM 항목 Value List</h1>
<div class="button-container" style="
  position: relative;
  width: fit-content;
  display: inline-block;
  margin: 0 0 20px 50px;
">
    <button onclick="location.href='https://syngchng.github.io/UTM-Param-Value-List/'">UTM Builder</button>
    </div><p id="loadingStatus" style="display: none;">옵션 목록 로딩 중...</p>
<div id="tableContainerWrapper">
    <div id="optionsTableContainer"><table><thead><tr><th>source</th><th>medium</th><th>utm_campaign_ad_type</th><th>utm_campaign_goal</th><th>utm_campaign_event_type</th><th>utm_campaign_product_category</th><th>utm_campaign_ad_target</th><th>utm_campaign_creative_type</th><th>utm_campaign_device_type</th><th>utm_content_content_action</th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody><td< td=""></td<></table></div>
</div>

<script>
    // 1. "옵션 마스터 시트"의 CSV 웹 게시 URL (반드시 실제 URL로 교체!)
    const MASTER_OPTIONS_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vShcppno7HuVQbjoQzbaBMEvoBGt6atss9FI_-F3qSh_pzgtxw7A4NPo6Y2EYoll2y5_8wMt08X_oV0/pub?gid=1861589139&single=true&output=csv';
    // 예시: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vYOUR_SHEET_ID/pub?gid=YOUR_GID&single=true&output=csv';

    document.addEventListener('DOMContentLoaded', async () => {
        const loadingStatusEl = document.getElementById('loadingStatus');
        const tableContainerEl = document.getElementById('optionsTableContainer');

        if (!MASTER_OPTIONS_CSV_URL || MASTER_OPTIONS_CSV_URL === '여기에_사용자님의_옵션_마스터_시트_CSV_게시_URL을_넣으세요') {
            loadingStatusEl.textContent = "오류: 구글 시트 CSV URL이 설정되지 않았습니다. 스크립트에서 MASTER_OPTIONS_CSV_URL 변수를 수정해주세요.";
            loadingStatusEl.style.color = "red";
            return;
        }
        
        try {
            loadingStatusEl.textContent = "옵션 목록 로딩 중...";
            const response = await fetch(MASTER_OPTIONS_CSV_URL, {
                cache: 'no-cache' 
            }); 

            if (!response.ok) {
                throw new Error(`마스터 옵션 CSV 로드 실패 (상태 코드: ${response.status})`);
            }

            const csvDataText = await response.text(); 
            
            if (!csvDataText.trim()) { 
                loadingStatusEl.textContent = "옵션 데이터가 비어있거나 가져올 수 없습니다.";
                tableContainerEl.innerHTML = '<p>표시할 옵션 데이터가 없습니다.</p>';
                return;
            }

            const tableElement = createOrganizedTableFromCsv(csvDataText); 
            tableContainerEl.innerHTML = ''; 
            tableContainerEl.appendChild(tableElement); 
            loadingStatusEl.style.display = 'none'; 

        } catch (error) {
            console.error("마스터 옵션 로딩 또는 표시 오류:", error);
            loadingStatusEl.textContent = `오류: ${error.message}`;
            loadingStatusEl.style.color = "red";
            tableContainerEl.innerHTML = '<p>옵션 목록을 불러오는 데 실패했습니다. 개발자 콘솔(F12)을 확인해주세요.</p>';
        }
    });

    // CSV 텍스트를 "정리된" HTML 테이블 요소로 변환하는 함수 (undefined 처리 강화)
    function createOrganizedTableFromCsv(csvDataText) {
        const lines = csvDataText.split(/\r?\n/).filter(line => line.trim() !== ""); 
        const table = document.createElement('table');

        if (lines.length === 0) {
            const tr = table.insertRow();
            const td = tr.insertCell();
            td.textContent = "표시할 데이터가 없습니다 (CSV 비어있음).";
            return table;
        }

        const headers = lines[0].split(',').map(header => header.trim().replace(/^"|"$/g, ''));
        const thead = table.createTHead();
        const headerRow = thead.insertRow();
        headers.forEach(headerText => {
            const th = document.createElement('th');
            th.textContent = headerText;
            headerRow.appendChild(th);
        });

        const categoryOptions = {}; 
        headers.forEach((header, colIndex) => {
            categoryOptions[header] = new Set(); 
            for (let i = 1; i < lines.length; i++) { 
                const cells = lines[i].split(',').map(cell => cell.trim().replace(/^"|"$/g, ''));
                if (cells.length > colIndex && cells[colIndex]) {
                    const value = String(cells[colIndex]).trim();
                    // "undefined" 문자열이거나 실제 빈 값은 Set에 추가하지 않음
                    if (value && value.toLowerCase() !== 'undefined') { 
                        categoryOptions[header].add(value);
                    }
                }
            }
        });

        let maxOptionsCount = 0;
        headers.forEach(header => {
            if (categoryOptions[header] && categoryOptions[header].size > maxOptionsCount) {
                maxOptionsCount = categoryOptions[header].size;
            }
        });
        
        const tbody = table.createTBody();
        if (maxOptionsCount === 0) { 
            const tr = tbody.insertRow();
            const td = tr.insertCell();
            td.colSpan = headers.length || 1;
            td.textContent = "모든 카테고리에 유효한 옵션 값이 없습니다."; 
            td.style.textAlign = "center";
            return table;
        }

        for (let i = 0; i < maxOptionsCount; i++) { 
            const tr = tbody.insertRow();
            headers.forEach(header => {
                const td = tr.insertCell();
                const optionsForThisHeaderArray = Array.from(categoryOptions[header] || new Set()); 
                let cellValue = optionsForThisHeaderArray[i] || ""; 

                // 최종적으로 셀에 값을 넣기 전에 undefined 문자열 및 실제 undefined 값 필터링
                if (cellValue === undefined || String(cellValue).trim().toLowerCase() === 'undefined') {
                    td.textContent = ""; // "undefined" 또는 실제 undefined면 빈칸으로 표시
                } else {
                    td.textContent = String(cellValue).trim(); // 앞뒤 공백 제거 후 표시
                }
            });
        }
        return table;
    }
</script>

</body></html>